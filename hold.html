<!DOCTYPE html>
<html>
<meta charset="UTF-8">
<meta name="robots" content="noindex, nofollow">
<title>Vipguide 2018</title>
<head>
	<link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700" rel="stylesheet">
    <link type="text/css" rel="stylesheet" href="/css/app.min.css" media="screen,projection" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!--
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/img/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon-16x16.png">
	<link rel="manifest" href="/assets/img/manifest.json">
	<link rel="mask-icon" href="/assets/img/safari-pinned-tab.svg" color="#5bbad5">
	<meta name="theme-color" content="#ffffff">
	-->
</head>
<body class="white">    	
        
<nav class="pink accent-5 nav-wrapper top">
	<div class="center title">Holdsammens√¶tning</div>
	<a class="refresh" onclick="refresh()"><i class="material-icons">refresh</i></a>
</nav>          
<script type="text/javascript" src="/scripts/min/app.min.js"></script>
<ul id="feed" class="feed collapsible collection team" data-collapsible="accordion">
<script id="feed-template" type="text/x-handlebars-template">
    <li class="collection-item avatar">
    <i class="circle">{{cells.Holdnummer}}</i>
    <span class="title">{{{escape cells.Navne}}}</span>
    </li>
  </script>
    </ul>
<script>
  Handlebars.registerHelper('escape', function(variable) {
  return variable.replace(/,/g,'<br>');
});
function loadFromLocalStorage() {
    var data = localStorage.getItem('hold');
    if (data == null)
    {
      return data;
    }
    
    return JSON.parse(data);
  }
  
  function refresh() {
    localStorage.setItem('hold', null);
    location.reload();
  } 
  
  function setInLocalStorage(rawData) {
    console.log('rawDAta');
    console.log(rawData);
    localStorage.setItem('hold', JSON.stringify(rawData));
  }
  
  function loadDataIntoSpreadSheet() {
    
    var data = loadFromLocalStorage();
    var mySpreadsheet = 'https://docs.google.com/spreadsheets/d/1ZKVCbxpCk4j6w-0UPLGYlylJejQLh_pp2mQ0rDUAmC8/edit#gid=817945410';
    // Compile the Handlebars template
    var FeedTemplate = Handlebars.compile($('#feed-template').html());
    // Out feed
    $('#feed').sheetrock({
      url: mySpreadsheet,
      query: "select D,E",
      rowTemplate: FeedTemplate,
      fetchSize: 7,
      callback: function (success, options, response) {
      console.log(success);
      console.log(options);
      setInLocalStorage(response.raw);
      console.log(response);
        $('.preloader-wrapper').hide();
      }
    }, data);
  }
// Compares first value to the second one allowing entering IF clouse if true.
// Otherwise entering ELSE clause if exist.
 Handlebars.registerHelper('ifEquals', function(a, b, options) {
  if (a === b) {
    return options.fn(this);
  }
  return options.inverse(this);
});
Handlebars.registerHelper('toLowerCase', function(str) {
  return str.toLowerCase();
});
Handlebars.registerHelper('substr', function(length, context, options) {
 if ( context.length > length ) {
  return context.substring(0, length);
 } else {
  return context;
 }
});
Handlebars.registerHelper("ifvalue", function(conditional, options) {
    if (conditional == options.hash.equals) {
        return options.fn(this);
    } else {
        return options.inverse(this);
    }
});
$(document).ready(function() {
  loadDataIntoSpreadSheet();
});
</script>
<div class="navbar-fixed">
    <nav class="white">
        <div class="nav-wrapper">
            <a href="/index.html"><i class="material-icons time">access_time</i></a>
    		<a href="/telefonliste.html"><i class="material-icons phone">contact_phone</i></a>
            <a href="/hold.html"><i class="material-icons people">people</i></a>
            <a href="/facts.html"><i class="material-icons facts">info_outline</i></a>
            <!--a href="/finurligheder.html"><i class="material-icons finurligheder">favorite</i></a></li-->
        </div>
    </nav>
</div>
</body>
</html>